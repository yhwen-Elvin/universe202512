<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>2025 · 秋冬序</title>

<style>
body {
  margin: 0;
  font-family: "Helvetica Neue","PingFang SC",sans-serif;
  background: #0b0e1a;
  color: #fff;
  min-height: 100vh;
  overflow-y: auto;
}

/* 通用区块 */
.section {
  display: none;
  max-width: 720px;
  padding: clamp(20px, 5vw, 36px);
  margin: 0 auto;
  box-sizing: border-box;
}

.section.active {
  display: block;
}

/* 非序章页面居中 */
.centered {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

p {
  line-height: 2;
}

/* 按钮 */
button {
  padding: 10px 28px;
  font-size: 15px;
  border: none;
  border-radius: 24px;
  background: #ffffff;
  color: #0b0e1a;
  cursor: pointer;
  min-width: 120px;
}

/* 输入框 */
input {
  padding: 10px;
  font-size: 16px;
  width: 160px;
  text-align: center;
  border-radius: 10px;
  border: none;
  margin-top: 18px;
}

/* 按钮排布 */
.button-row {
  display: flex;
  justify-content: center;
  gap: 16px;
  flex-wrap: wrap;
  margin-top: 28px;
}

/* 正文 */
.chapter-text {
  text-align: left;
  white-space: pre-line;
  line-height: 2;
  opacity: 0.92;
  margin-bottom: 36px;
}

/* 音频 */
.audio-block {
  display: flex;
  justify-content: center;
  margin-bottom: 22px;
}

audio {
  width: 100%;
  max-width: 420px;
}

/* 答案 */
.answer {
  margin-top: 20px;
  display: none;
  opacity: 0.85;
}

/* 播放暗幕 */
#audioMask {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  z-index: 500;
  display: none;
  pointer-events: none;
}

/* 星光 */
.star {
  position: fixed;
  z-index: 999;
  width: 3px;
  height: 3px;
  background: white;
  border-radius: 50%;
  opacity: 0.8;
  pointer-events: none;
  animation: float 6s linear forwards;
  will-change: transform, opacity;
}

@keyframes float {
  from {
    transform: translateY(0);
    opacity: 0.8;
  }
  to {
    transform: translateY(-160px);
    opacity: 0;
  }
}
</style>
</head>

<body>

<div id="audioMask"></div>

<!-- 首页 -->
<div id="home" class="section active centered" style="text-align:center;">
  <p>
    欢迎你，小夏。<br>
    伟大的探险家，<br>
    欢迎回到这颗星球。
  </p>
  <div class="button-row">
    <button onclick="showSection('prologue')">着陆</button>
  </div>
</div>

<!-- 序章（保持可滚动） -->
<div id="prologue" class="section" style="text-align:center;">
  <p>
    我发觉，我们依赖视觉太多，<br>
    用文字记录、用图片记录、用视频记录。<br><br>

    在这里，我决定用音频记录。<br><br>

    如果文字、图片、视频<br>
    都能把我们拉回彼时彼刻，<br>
    那么，音频是不是也可以呢？<br><br>

    如果你没有参与彼时彼刻的故事，<br>
    那么，音频是不是可以<br>
    邀请你进入那个时空呢？<br><br>

    在一个安静的时刻，<br>
    戴上耳机，合上眼，<br>
    把自己抛向大气层。<br><br>

    我们就这样，<br>
    沉入这片星系，<br>
    拥抱这个宇宙。
  </p>

  <div class="button-row">
    <button onclick="showSection('home')">出发</button>
    <button onclick="showSection('password')">探索</button>
  </div>
</div>

<!-- 密码 -->
<div id="password" class="section centered" style="text-align:center;">
  <p>请输入星辰编号</p>
  <input id="pwdInput" maxlength="4">
  <div class="button-row">
    <button onclick="checkPassword()">确认</button>
    <button onclick="showSection('prologue')">回到序章</button>
  </div>
</div>

<!-- 章节 -->
<div id="chapter" class="section centered">
  <div id="chapterText" class="chapter-text"></div>
  <div id="answerText" class="answer"></div>
  <div id="audioContainer"></div>

  <div class="button-row">
    <button id="answerBtn" onclick="showAnswer()" style="display:none;">查看答案</button>
    <button onclick="showSection('prologue')">回到序章</button>
  </div>
</div>

<!-- 生日 -->
<div id="birthday" class="section centered" style="text-align:center;">
  <h2>生日快乐，小夏</h2>
  <p>愿新的轨道，<br>仍有星辰相伴。</p>
  <div class="button-row">
    <button onclick="showSection('prologue')">回到序章</button>
  </div>
</div>

<script>
let starTimer = null;
let playingCount = 0;

const chapters = {
  "1128": { text:`11月28日 · 朝天门`, files:["voice01.mp3"] },
  "1213": { text:`12月13日 · 南理工`, files:["voice02.mp3"] },
  "1205": { text:`12月5日 · 燕雀湖 / 明孝陵`, files:["voice03.mp3","voice04.mp3"] },
  "0526": {
    text:`12月5日 · 明孝陵`,
    answer:`答：是婴儿车走过石子路的声音。`,
    files:["voice05.mp3","voice06.mp3"]
  },
  "1125": { text:`11月25日 · 南理工`, files:["voice07.mp3"] }
};

function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  stopStars();
}

function checkPassword() {
  const pwd = pwdInput.value;

  if (pwd === "1218") {
    showSection("birthday");
    startStars();
    return;
  }

  if (!chapters[pwd]) {
    alert("这组坐标尚未解锁。");
    return;
  }

  const c = chapters[pwd];
  chapterText.innerText = c.text;
  audioContainer.innerHTML = "";
  answerText.style.display = "none";

  if (pwd === "0526") {
    answerBtn.style.display = "inline-block";
    answerText.innerText = c.answer;
  } else {
    answerBtn.style.display = "none";
  }

  c.files.forEach(f => {
    const audio = document.createElement("audio");
    audio.controls = true;
    audio.src = f;

    audio.onplay = () => {
      playingCount++;
      audioMask.style.display = "block";
    };
    audio.onpause = audio.onended = () => {
      playingCount--;
      if (playingCount <= 0) audioMask.style.display = "none";
    };

    const div = document.createElement("div");
    div.className = "audio-block";
    div.appendChild(audio);
    audioContainer.appendChild(div);
  });

  showSection("chapter");
}

function showAnswer() {
  answerText.style.display = "block";
  answerBtn.style.display = "none";
}

function startStars() {
  if (starTimer) return;
  starTimer = setInterval(() => {
    const s = document.createElement("div");
    s.className = "star";
    s.style.left = Math.random() * window.innerWidth + "px";
    s.style.bottom = "0";
    document.body.appendChild(s);
    setTimeout(() => s.remove(), 6000);
  }, 180);
}

function stopStars() {
  clearInterval(starTimer);
  starTimer = null;
}
</script>

</body>
</html>
